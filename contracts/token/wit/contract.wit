package kontor:contract;

world contract {
    include kontor:built-in/built-in;
    use kontor:built-in/context.{view-context, proc-context, signer};
    use kontor:built-in/error.{error};
    use kontor:built-in/numbers.{integer, decimal};
    use kontor:built-in/foreign.{contract-address};
    
    // Use the shared Balance resource from kontor:assets
    use kontor:assets/balance.{balance, split-result};

    export init: func(ctx: borrow<proc-context>);

    export mint: func(ctx: borrow<proc-context>, n: integer);
    export transfer: func(ctx: borrow<proc-context>, to: string, n: integer) -> result<_, error>;
    
    export balance: func(ctx: borrow<view-context>, acc: string) -> option<integer>;
    export balance-or-zero: func(ctx: borrow<view-context>, acc: string) -> integer;
    export total-supply: func(ctx: borrow<view-context>) -> integer;
    export balance-log10: func(ctx: borrow<view-context>, acc: string) -> option<decimal>;
    
    // Resource-based asset management - Balance moves, cannot be copied
    export withdraw: func(ctx: borrow<proc-context>, amount: integer) -> result<balance, error>;
    export deposit: func(ctx: borrow<proc-context>, recipient: string, bal: balance) -> result<_, error>;
    
    // Split and merge operations - consume and produce resources
    // Returns both the split amount and any remainder as a split-result record
    export split: func(ctx: borrow<proc-context>, bal: balance, split-amount: integer) -> result<split-result, error>;
    export merge: func(ctx: borrow<proc-context>, a: balance, b: balance) -> result<balance, error>;
}

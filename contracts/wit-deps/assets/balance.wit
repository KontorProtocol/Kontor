// Shared Balance resource definition for cross-contract asset transfers
// This provides compile-time linear type safety across contract boundaries

package kontor:assets;

world balance {
    use kontor:built-in/numbers.{integer};
    use kontor:built-in/foreign.{contract-address};

    // The canonical Balance resource - represents ownership of tokens
    // Resources enforce move semantics: they cannot be copied, only moved
    resource balance {
        // Constructor: Create a new balance with specified amount and token
        constructor(amount: integer, token: contract-address);
        
        // Get the amount of tokens this balance represents
        amount: func() -> integer;
        
        // Get the token contract address this balance is from
        token: func() -> contract-address;
        
        // Check if balance is zero
        is-zero: func() -> bool;
        
        // Split this balance into two parts
        // Consumes self, returns the split amount and remainder
        split: func(amount: integer) -> split-result;
        
        // Merge another balance into this one
        // Consumes both balances, returns new combined balance
        merge: static func(first: balance, second: balance) -> result<balance, string>;
        
        // Consume this balance (destroys it)
        // Used when tokens are burned or otherwise removed from circulation
        consume: func();
    }
    
    // Result of splitting a balance into two parts
    record split-result {
        // The requested split amount
        split: balance,
        
        // The remainder (if any)
        remainder: option<balance>,
    }
}
